@using QRCodeBasedMetroTicketingSystem.Domain.Entities
@model IEnumerable<TicketViewModel>

@{
    ViewData["Title"] = "My QR Ticket";
}

<div class="content-wrapper my-qr-ticket-section">
    <div class="content-header">
        <h2 class="content-title">My QR Tickets</h2>
    </div>

    <div class="action-buttons">
        <a asp-area="User" asp-controller="Ticket" asp-action="MyQrTickets" asp-route-status="@TicketStatus.Active" class="btn btn-outline-primary me-2 @(Context.Request.Query["status"] == "Active" ? "active" : "")">Active</a>
        <a asp-area="User" asp-controller="Ticket" asp-action="MyQrTickets" asp-route-status="@TicketStatus.InUse" class="btn btn-outline-primary ms-2 @(Context.Request.Query["status"] == "InUse" ? "active" : "")">In Use</a>
    </div>

    @if (!Model.Any())
    {
        <div>
            @if (Context.Request.Query["status"] == "Active")
            {
                <p>You don't have any active tickets. Purchase a new ticket to get started.</p>
            }
            else
            {
                <p>You don't have any tickets currently in use.</p>
            }
        </div>
    }

    @foreach (var ticket in Model)
    {
        var statusClass = ticket.Status.ToString().ToLower();
        <div class="ticket-card @statusClass">
            <div class="ticket-header">
                <h3 class="ticket-title">@ticket.OriginStationName to @ticket.DestinationStationName</h3>
                <span class="ticket-status @statusClass">@ticket.Status</span>
            </div>
            <div class="ticket-details">
                <div class="ticket-info-row">
                    <div class="ticket-info-label">From</div>
                    <div class="ticket-info-value">@ticket.OriginStationName</div>
                </div>
                <div class="ticket-info-row">
                    <div class="ticket-info-label">To</div>
                    <div class="ticket-info-value">@ticket.DestinationStationName</div>
                </div>
                <div class="ticket-info-row">
                    <div class="ticket-info-label">Valid Until</div>
                    <div class="ticket-info-value">@ticket.ExpiryTime.ToString("MMM d, yyyy h:mm tt")</div>
                </div>
                <div class="ticket-info-row">
                    <div class="ticket-info-label">Fare</div>
                    <div class="ticket-info-value"><span class="taka-icon">৳</span>@ticket.FareAmount</div>
                </div>
            </div>
            <div class="ticket-actions">
                <button class="btn btn-outline-primary">
                    <i class="fas fa-download me-2"></i> Download
                </button>
                <button class="btn btn-primary">
                    <i class="fas fa-qrcode me-2"></i> Show QR
                </button>
            </div>
        </div>
    }
</div>
